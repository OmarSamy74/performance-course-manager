import XLSX from 'xlsx';
import path from 'path';
import fs from 'fs';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Sample data for leads
const sampleLeads = [
  {
    'ุงูุงุณู': 'ุฃุญูุฏ ูุญูุฏ ุนูู',
    'ุฑูู ุงููุงุชู': '01012345678',
    'ุงููุตุฏุฑ': 'ููุณุจูู',
    'ููุงุญุธุงุช': 'ููุชู ุจุงูููุฑุณุ ูุฑูุฏ ูุนุฑูุฉ ุงูุชูุงุตูู'
  },
  {
    'ุงูุงุณู': 'ูุงุทูุฉ ุฃุญูุฏ',
    'ุฑูู ุงููุงุชู': '01234567890',
    'ุงููุตุฏุฑ': 'ุฅูุณุชุฌุฑุงู',
    'ููุงุญุธุงุช': 'ุณุฃุชูุงุตู ูุนู ุบุฏุงู'
  },
  {
    'ุงูุงุณู': 'ูุญูุฏ ุฎุงูุฏ',
    'ุฑูู ุงููุงุชู': '01123456789',
    'ุงููุตุฏุฑ': 'Direct',
    'ููุงุญุธุงุช': 'ุฌุงุก ูู ุฎูุงู ุตุฏูู'
  },
  {
    'ุงูุงุณู': 'ุณุงุฑุฉ ูุญููุฏ',
    'ุฑูู ุงููุงุชู': '01567890123',
    'ุงููุตุฏุฑ': 'ุฌูุฌู',
    'ููุงุญุธุงุช': 'ุจุญุซ ุนู ููุฑุณ ูุฑุฉ ูุฏู'
  },
  {
    'ุงูุงุณู': 'ุนูู ุญุณู',
    'ุฑูู ุงููุงุชู': '01098765432',
    'ุงููุตุฏุฑ': 'ููุณุจูู',
    'ููุงุญุธุงุช': ''
  },
  {
    'ุงูุงุณู': 'ูุฑูู ุนุจุฏุงููู',
    'ุฑูู ุงููุงุชู': '01298765432',
    'ุงููุตุฏุฑ': 'ุฅูุณุชุฌุฑุงู',
    'ููุงุญุธุงุช': 'ููุชู ุฌุฏุงูุ ูุฑูุฏ ุงูุชุณุฌูู ูุฑูุจุงู'
  },
  {
    'ุงูุงุณู': 'ููุณู ุฅุจุฑุงููู',
    'ุฑูู ุงููุงุชู': '01187654321',
    'ุงููุตุฏุฑ': 'Direct',
    'ููุงุญุธุงุช': 'ุฌุงุก ูู ุฎูุงู ุฅุนูุงู'
  },
  {
    'ุงูุงุณู': 'ููุฑุง ุณุนูุฏ',
    'ุฑูู ุงููุงุชู': '01023456789',
    'ุงููุตุฏุฑ': 'ููุณุจูู',
    'ููุงุญุธุงุช': 'ูุฑูุฏ ูุนุฑูุฉ ุงูุฃุณุนุงุฑ'
  },
  {
    'ุงูุงุณู': 'ุฎุงูุฏ ูุคุงุฏ',
    'ุฑูู ุงููุงุชู': '01245678901',
    'ุงููุตุฏุฑ': 'ุฌูุฌู',
    'ููุงุญุธุงุช': ''
  },
  {
    'ุงูุงุณู': 'ูููู ูุตุทูู',
    'ุฑูู ุงููุงุชู': '01156789012',
    'ุงููุตุฏุฑ': 'ุฅูุณุชุฌุฑุงู',
    'ููุงุญุธุงุช': 'ููุชู ุจุงูููุฑุณ ุงููุชูุฏู'
  }
];

// Create workbook
const workbook = XLSX.utils.book_new();

// Create worksheet from data
const worksheet = XLSX.utils.json_to_sheet(sampleLeads);

// Set column widths
worksheet['!cols'] = [
  { wch: 20 }, // ุงูุงุณู
  { wch: 15 }, // ุฑูู ุงููุงุชู
  { wch: 15 }, // ุงููุตุฏุฑ
  { wch: 40 }  // ููุงุญุธุงุช
];

// Add worksheet to workbook
XLSX.utils.book_append_sheet(workbook, worksheet, 'ุงูุนููุงุก');

// Create output directory if it doesn't exist
const outputDir = path.join(__dirname, '..', 'public', 'templates');
if (!fs.existsSync(outputDir)) {
  fs.mkdirSync(outputDir, { recursive: true });
}

// Write file
const outputPath = path.join(outputDir, 'leads-template.xlsx');
XLSX.writeFile(workbook, outputPath);

console.log('โ ุชู ุฅูุดุงุก ููู Excel ุจูุฌุงุญ!');
console.log(`๐ ุงูููู ููุฌูุฏ ูู: ${outputPath}`);
console.log('\n๐ ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ:');
console.log('  - ุงูุงุณู (ูุทููุจ)');
console.log('  - ุฑูู ุงููุงุชู ุฃู ุงููุงุชู (ูุทููุจ)');
console.log('  - ุงููุตุฏุฑ (ุงุฎุชูุงุฑู)');
console.log('  - ููุงุญุธุงุช (ุงุฎุชูุงุฑู)');
console.log('\n๐ก ููููู ุงูุขู:');
console.log('  1. ูุชุญ ุงูููู ูุชุนุฏูู ุงูุจูุงูุงุช');
console.log('  2. ุฅุถุงูุฉ ุนููุงุก ุฌุฏุฏ');
console.log('  3. ุฑูุน ุงูููู ูู ุตูุญุฉ ุงููุจูุนุงุช');
